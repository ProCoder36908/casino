<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Casino</title>
    <style>
        /* CSS STYLES */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: #fff;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: #1e1e1e;
            padding: 15px 0;
            text-align: center;
            border-bottom: 3px solid #ffcc00;
            margin-bottom: 20px;
        }

        h1 {
            color: #ffcc00;
            margin: 0;
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stats {
            display: flex;
            flex-direction: column;
        }

        .stat {
            font-size: 1.2rem;
            margin: 5px 0;
        }

        .bank {
            color: #4caf50;
        }

        .debt {
            color: #f44336;
        }

        .buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .btn-borrow-100 {
            background-color: #4caf50;
            color: white;
        }

        .btn-borrow-500 {
            background-color: #ff9800;
            color: white;
        }

        .btn-borrow-1000 {
            background-color: #e91e63;
            color: white;
        }

        .btn-pay {
            background-color: #2196f3;
            color: white;
        }

        .games-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .game-btn {
            padding: 15px;
            text-align: center;
            font-size: 1.1rem;
        }

        .blackjack-btn {
            background-color: #3f51b5;
            color: white;
        }

        .roulette-btn {
            background-color: #9c27b0;
            color: white;
        }

        .slots-btn {
            background-color: #ff5722;
            color: white;
        }

        .poker-btn {
            background-color: #009688;
            color: white;
        }

        .craps-btn {
            background-color: #795548;
            color: white;
        }

        .baccarat-btn {
            background-color: #607d8b;
            color: white;
        }

        .game-container {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            min-height: 400px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .game-title {
            font-size: 1.8rem;
            margin-top: 0;
            margin-bottom: 15px;
            color: #ffcc00;
        }

        .game-result {
            font-size: 1.3rem;
            margin-bottom: 20px;
            min-height: 30px;
        }

        .card {
            width: 80px;
            height: 120px;
            background-color: white;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            margin: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .card-red {
            color: #e91e63;
        }

        .card-black {
            color: #000;
        }

        .card-value {
            font-size: 2rem;
        }

        .card-suit {
            position: absolute;
            font-size: 1rem;
            bottom: 5px;
            right: 5px;
        }

        .hand {
            display: flex;
            margin-bottom: 20px;
        }

        .hidden-card {
            background-color: #3f51b5;
            color: #3f51b5;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .roulette-bet-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }

        select, input {
            padding: 8px;
            background-color: #333;
            color: white;
            border: 1px solid #555;
            border-radius: 5px;
        }

        .roulette-wheel {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 5px;
            max-width: 500px;
            margin: 20px auto;
        }

        .roulette-number {
            padding: 10px 0;
            text-align: center;
            border-radius: 5px;
            font-weight: bold;
        }

        .roulette-red {
            background-color: #e91e63;
        }

        .roulette-black {
            background-color: #333;
        }

        .roulette-green {
            background-color: #4caf50;
        }

        .roulette-result {
            font-size: 3rem;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
        }

        .red {
            color: #e91e63;
        }

        .black {
            color: #fff;
        }

        .green {
            color: #4caf50;
        }

        .slot-machine {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
        }

        .slot-reel {
            width: 100px;
            height: 150px;
            background-color: #333;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
        }

        .dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .dice {
            width: 80px;
            height: 80px;
            background-color: white;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            color: black;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .baccarat-score {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            font-size: 1.5rem;
        }

        .winning {
            color: #4caf50;
            font-weight: bold;
        }

        .losing {
            color: #f44336;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .buttons {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .card {
                width: 60px;
                height: 90px;
                font-size: 1.2rem;
            }
        }

        /* Add new styles for statistics and achievements */
        .stats-panel {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stat-item {
            background-color: #333;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .achievements-panel {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .achievement {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background-color: #333;
            border-radius: 5px;
            margin-bottom: 10px;
            opacity: 0.5;
            transition: opacity 0.3s ease;
        }

        .achievement.unlocked {
            opacity: 1;
            background-color: #4caf50;
        }

        .achievement-icon {
            font-size: 24px;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px;
            background-color: #333;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
        }

        .light-theme {
            background-color: #f0f0f0;
            color: #333;
        }

        .light-theme .stats-bar,
        .light-theme .game-container,
        .light-theme .stats-panel,
        .light-theme .achievements-panel {
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .light-theme .stat-item,
        .light-theme .achievement {
            background-color: #f5f5f5;
        }

        /* Add styles for social features */
        .social-panel {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .leaderboard {
            background-color: #333;
            padding: 15px;
            border-radius: 5px;
        }

        .leaderboard h3 {
            margin-top: 0;
            color: #ffcc00;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid #444;
        }

        .leaderboard-item:last-child {
            border-bottom: none;
        }

        .chat-container {
            background-color: #333;
            padding: 15px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            height: 300px;
        }

        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            margin-bottom: 10px;
            padding: 10px;
            background-color: #2a2a2a;
            border-radius: 5px;
        }

        .chat-message {
            margin-bottom: 8px;
            padding: 8px;
            background-color: #444;
            border-radius: 5px;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex-grow: 1;
        }

        .player-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 10px;
        }

        .player-info {
            display: flex;
            align-items: center;
        }

        .light-theme .social-panel,
        .light-theme .leaderboard,
        .light-theme .chat-container {
            background-color: #fff;
        }

        .light-theme .chat-messages {
            background-color: #f5f5f5;
        }

        .light-theme .chat-message {
            background-color: #e0e0e0;
        }

        /* Add styles for settings panel */
        .settings-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px;
            background-color: #333;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            z-index: 1000;
        }

        .settings-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: none;
        }

        .settings-panel.active {
            display: block;
        }

        .settings-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }

        .settings-overlay.active {
            display: block;
        }

        .settings-panel h3 {
            margin-top: 0;
            color: #ffcc00;
        }

        .settings-option {
            margin: 15px 0;
        }

        .settings-option button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
        }

        .light-theme .settings-panel {
            background-color: #fff;
        }
    </style>
</head>
<body>
    <button class="settings-btn" onclick="toggleSettings()">⚙️ Settings</button>
    <div class="settings-overlay" id="settings-overlay"></div>
    <div class="settings-panel" id="settings-panel">
        <h3>Settings</h3>
        <div class="settings-option">
            <button class="btn-borrow-100" onclick="resetGame()">Reset Game</button>
            <button class="btn-borrow-500" onclick="resetStats()">Reset Statistics</button>
            <button class="btn-borrow-1000" onclick="toggleSettings()">Close</button>
        </div>
    </div>
    <button class="theme-toggle" onclick="toggleTheme()">🌓 Toggle Theme</button>
    <header>
        <h1>VIRTUAL CASINO</h1>
    </header>

    <div class="container">
        <div class="stats-bar">
            <div class="stats">
                <div class="stat">Bank: <span id="bank-amount" class="bank">$0</span></div>
                <div class="stat">Debt: <span id="debt-amount" class="debt">$0</span></div>
            </div>
            <div class="buttons">
                <button class="btn-borrow-100" onclick="borrowMoney(100)">Borrow $100</button>
                <button class="btn-borrow-500" onclick="borrowMoney(500)">Borrow $500</button>
                <button class="btn-borrow-1000" onclick="borrowMoney(1000)">Borrow $1000</button>
                <button class="btn-pay" onclick="payDebt(100)">Pay $100</button>
                <button class="btn-pay" onclick="payDebt(500)">Pay $500</button>
            </div>
        </div>

        <div class="stats-panel">
            <h3>Statistics</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div>Total Wins</div>
                    <div id="total-wins">0</div>
                </div>
                <div class="stat-item">
                    <div>Total Losses</div>
                    <div id="total-losses">0</div>
                </div>
                <div class="stat-item">
                    <div>Biggest Win</div>
                    <div id="biggest-win">$0</div>
                </div>
                <div class="stat-item">
                    <div>Current Streak</div>
                    <div id="current-streak">0</div>
                </div>
            </div>
        </div>

        <div class="achievements-panel">
            <h3>Achievements</h3>
            <div id="achievements-list">
                <!-- Achievements will be added here -->
            </div>
        </div>

        <div class="social-panel">
            <div class="leaderboard">
                <h3>Leaderboard</h3>
                <div id="leaderboard-list">
                    <!-- Leaderboard items will be added here -->
                </div>
            </div>
            <div class="chat-container">
                <h3>Chat</h3>
                <div class="chat-messages" id="chat-messages">
                    <!-- Chat messages will be added here -->
                </div>
                <div class="chat-input">
                    <input type="text" id="chat-input" placeholder="Type your message...">
                    <button onclick="sendChatMessage()">Send</button>
                </div>
            </div>
        </div>

        <div class="games-menu">
            <button class="game-btn blackjack-btn" onclick="startGame('blackjack')">Blackjack</button>
            <button class="game-btn roulette-btn" onclick="startGame('roulette')">Roulette</button>
            <button class="game-btn slots-btn" onclick="startGame('slots')">Slots</button>
            <button class="game-btn poker-btn" onclick="startGame('poker')">Poker</button>
            <button class="game-btn craps-btn" onclick="startGame('craps')">Craps</button>
            <button class="game-btn baccarat-btn" onclick="startGame('baccarat')">Baccarat</button>
            <button class="game-btn holdem-btn" onclick="startGame('holdem')">Texas Hold'em</button>
            <button class="game-btn keno-btn" onclick="startGame('keno')">Keno</button>
        </div>

        <div id="game-container" class="game-container">
            <h2 class="game-title">Welcome to the Virtual Casino</h2>
            <div id="game-result" class="game-result">Select a game to play!</div>
            <div id="game-content"></div>
        </div>
    </div>

    <script>
        // GAME STATE
        let bank = parseInt(localStorage.getItem('bank')) || 0;
        let debt = parseInt(localStorage.getItem('debt')) || 0;
        let currentGame = null;
        let blackjackState = {};
        let rouletteState = { bet: { type: 'number', value: 0, amount: 10 } };
        let pokerState = {};
        let slotsState = {};
        let crapsState = {};
        let baccaratState = {};
        let holdemState = {};
        let kenoState = {};

        // Add sound effects
        const sounds = {
            win: new Audio('https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3'),
            lose: new Audio('https://assets.mixkit.co/active_storage/sfx/2001/2001-preview.mp3'),
            deal: new Audio('https://assets.mixkit.co/active_storage/sfx/2002/2002-preview.mp3'),
            spin: new Audio('https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3'),
            click: new Audio('https://assets.mixkit.co/active_storage/sfx/2004/2004-preview.mp3')
        };

        // Statistics tracking
        let stats = JSON.parse(localStorage.getItem('casinoStats')) || {
            totalWins: 0,
            totalLosses: 0,
            biggestWin: 0,
            currentStreak: 0,
            gamesPlayed: 0,
            totalWon: 0,
            totalLost: 0
        };

        // Achievements
        const achievements = [
            { id: 'high_roller', name: 'High Roller', description: 'Place a bet of $1000 or more', icon: '💰', unlocked: false },
            { id: 'lucky_streak', name: 'Lucky Streak', description: 'Win 5 times in a row', icon: '🔥', unlocked: false },
            { id: 'debt_free', name: 'Debt Free', description: 'Pay off all your debt', icon: '💪', unlocked: false },
            { id: 'jackpot_hunter', name: 'Jackpot Hunter', description: 'Win $1000 or more in a single bet', icon: '🎯', unlocked: false },
            { id: 'blackjack_master', name: 'Blackjack Master', description: 'Get a natural blackjack', icon: '🃏', unlocked: false },
            { id: 'roulette_king', name: 'Roulette King', description: 'Win on a single number bet', icon: '🎲', unlocked: false },
            { id: 'slot_machine', name: 'Slot Machine', description: 'Hit three 7s in slots', icon: '🎰', unlocked: false },
            { id: 'poker_pro', name: 'Poker Pro', description: 'Win with a royal flush', icon: '👑', unlocked: false }
        ];

        // Load achievements from localStorage
        let unlockedAchievements = JSON.parse(localStorage.getItem('achievements')) || [];

        // Add social features
        let playerName = localStorage.getItem('playerName') || 'Player' + Math.floor(Math.random() * 1000);
        let playerAvatar = localStorage.getItem('playerAvatar') || '🎲';
        let chatMessages = JSON.parse(localStorage.getItem('chatMessages')) || [];
        let leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];

        // UTILITY FUNCTIONS
        function updateUI() {
            document.getElementById('bank-amount').textContent = '$' + bank;
            document.getElementById('debt-amount').textContent = '$' + debt;
            // Save to local storage
            localStorage.setItem('bank', bank);
            localStorage.setItem('debt', debt);
        }

        function setGameResult(message) {
            document.getElementById('game-result').textContent = message;
        }

        function getRandomCard() {
            const suits = ['♥', '♦', '♠', '♣'];
            const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
            
            const suit = suits[Math.floor(Math.random() * suits.length)];
            const value = values[Math.floor(Math.random() * values.length)];
            
            return { suit, value };
        }

        function calculateHandValue(cards) {
            let value = 0;
            let aces = 0;
            
            for (const card of cards) {
                if (card.value === 'A') {
                    aces += 1;
                    value += 11;
                } else if (['K', 'Q', 'J'].includes(card.value)) {
                    value += 10;
                } else {
                    value += parseInt(card.value);
                }
            }
            
            while (value > 21 && aces > 0) {
                value -= 10;
                aces -= 1;
            }
            
            return value;
        }

        function generateDeck() {
            const suits = ['♥', '♦', '♠', '♣'];
            const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            const deck = [];
            
            for (const suit of suits) {
                for (const value of values) {
                    deck.push({ suit, value });
                }
            }
            
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            
            return deck;
        }

        function dealCards(deck, count) {
            return deck.splice(0, count);
        }

        function calculateBaccaratScore(cards) {
            let score = 0;
            
            for (const card of cards) {
                if (['10', 'J', 'Q', 'K'].includes(card.value)) {
                    score += 0;
                } else if (card.value === 'A') {
                    score += 1;
                } else {
                    score += parseInt(card.value);
                }
            }
            
            return score % 10;
        }

        // GAME FUNCTIONS
        function startBlackjack() {
            if (bank < 10) {
                setGameResult("You need at least $10 to play Blackjack!");
                return;
            }
            
            blackjackState = {
                playerCards: [getRandomCard(), getRandomCard()],
                dealerCards: [getRandomCard(), getRandomCard()],
                gameOver: false,
                playerStood: false,
                betAmount: 10
            };
            
            blackjackState.playerValue = calculateHandValue(blackjackState.playerCards);
            blackjackState.dealerValue = calculateHandValue([blackjackState.dealerCards[0]]);
            
            renderBlackjack();
            setGameResult("Blackjack game started! Place your bet and hit or stand!");
            
            if (blackjackState.playerValue === 21) {
                blackjackState.gameOver = true;
                bank += blackjackState.betAmount * 1.5;
                updateUI();
                setGameResult("Blackjack! You win $" + (blackjackState.betAmount * 1.5) + "!");
            }
        }

        function startRoulette() {
            if (bank < 10) {
                setGameResult("You need at least $10 to play Roulette!");
                return;
            }
            
            rouletteState = {
                bet: { type: 'number', value: 0, amount: 10 },
                result: null
            };
            
            renderRoulette();
            setGameResult("Place your bet and spin the wheel!");
        }

        function startSlots() {
            if (bank < 5) {
                setGameResult("You need at least $5 to play Slots!");
                return;
            }
            
            slotsState = {
                reels: ['?', '?', '?'],
                bet: 5
            };
            
            renderSlots();
            setGameResult("Place your bet and spin the reels!");
        }

        function startPoker() {
            if (bank < 20) {
                setGameResult("You need at least $20 to play Poker!");
                return;
            }
            
            const deck = generateDeck();
            const playerHand = dealCards(deck, 5);
            const computerHand = dealCards(deck, 5);
            
            pokerState = {
                deck: deck,
                playerHand: playerHand,
                computerHand: computerHand,
                selectedCards: [false, false, false, false, false],
                gameStage: 'initial',
                betAmount: 20
            };
            
            renderPoker();
            setGameResult("Select cards to hold, then click 'Draw'");
        }

        function startCraps() {
            if (bank < 10) {
                setGameResult("You need at least $10 to play Craps!");
                return;
            }
            
            crapsState = {
                dice: [1, 1],
                point: 0,
                betAmount: 10,
                gameStage: 'come-out'
            };
            
            renderCraps();
            setGameResult("Place your bet on the Pass Line and roll the dice!");
        }

        function startBaccarat() {
            if (bank < 25) {
                setGameResult("You need at least $25 to play Baccarat!");
                return;
            }
            
            baccaratState = {
                playerCards: [],
                bankerCards: [],
                playerScore: 0,
                bankerScore: 0,
                betAmount: 25,
                betOn: 'player',
                gameStage: 'betting'
            };
            
            renderBaccarat();
            setGameResult("Place your bet on Player, Banker, or Tie.");
        }

        function startHoldem() {
            if (bank < 50) {
                setGameResult("You need at least $50 to play Texas Hold'em!");
                return;
            }

            const deck = generateDeck();
            holdemState = {
                deck: deck,
                playerHand: dealCards(deck, 2),
                communityCards: [],
                pot: 50,
                gameStage: 'preflop',
                betAmount: 50,
                playerFolded: false,
                dealerHand: dealCards(deck, 2)
            };

            bank -= holdemState.betAmount;
            updateUI();
            playSound('deal');
            renderHoldem();
            setGameResult("Place your bet and see the flop!");
        }

        function startKeno() {
            if (bank < 10) {
                setGameResult("You need at least $10 to play Keno!");
                return;
            }

            kenoState = {
                selectedNumbers: [],
                drawnNumbers: [],
                betAmount: 10,
                gameStage: 'selecting'
            };

            renderKeno();
            setGameResult("Select your numbers (1-80) and place your bet!");
        }

        // Make all functions globally accessible
        window.borrowMoney = function(amount) {
            if (debt > 0) {
                setGameResult("You can't borrow more money while in debt! Pay your debt first.");
                return;
            }
            bank += amount;
            debt += amount;
            updateUI();
            setGameResult(`You borrowed $${amount}. Your total debt is now $${debt}.`);
        };

        window.payDebt = function(amount) {
            if (amount > bank) {
                setGameResult(`You don't have enough money to pay $${amount}!`);
                return;
            }
            if (amount > debt) {
                setGameResult(`You can't pay more than your debt of $${debt}!`);
                return;
            }
            
            bank -= amount;
            debt -= amount;
            updateUI();
            setGameResult(`You paid $${amount} toward your debt. Remaining debt: $${debt}`);
        };

        window.startGame = function(game) {
            currentGame = game;
            document.querySelector('.game-title').textContent = game.charAt(0).toUpperCase() + game.slice(1);
            
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';
            
            switch(game) {
                case 'blackjack':
                    startBlackjack();
                    break;
                case 'roulette':
                    startRoulette();
                    break;
                case 'slots':
                    startSlots();
                    break;
                case 'poker':
                    startPoker();
                    break;
                case 'craps':
                    startCraps();
                    break;
                case 'baccarat':
                    startBaccarat();
                    break;
                case 'holdem':
                    startHoldem();
                    break;
                case 'keno':
                    startKeno();
                    break;
            }
        };

        // Make game functions globally accessible
        window.startBlackjack = startBlackjack;
        window.startRoulette = startRoulette;
        window.startSlots = startSlots;
        window.startPoker = startPoker;
        window.startCraps = startCraps;
        window.startBaccarat = startBaccarat;
        window.startHoldem = startHoldem;
        window.startKeno = startKeno;

        // Render functions
        function renderBlackjack() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';
            
            if (!blackjackState.gameOver) {
                addCustomBetInput(gameContent, 10, blackjackState.betAmount, (newBet) => {
                    blackjackState.betAmount = newBet;
                });
            }
            
            // Player's hand
            const playerHandDiv = document.createElement('div');
            playerHandDiv.innerHTML = `<h3>Your Hand (${blackjackState.playerValue})</h3>`;
            
            const playerCardsDiv = document.createElement('div');
            playerCardsDiv.className = 'hand';
            
            blackjackState.playerCards.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                cardDiv.innerHTML = `
                    <span class="card-value">${card.value}</span>
                    <span class="card-suit">${card.suit}</span>
                `;
                playerCardsDiv.appendChild(cardDiv);
            });
            
            playerHandDiv.appendChild(playerCardsDiv);
            gameContent.appendChild(playerHandDiv);
            
            // Dealer's hand
            const dealerHandDiv = document.createElement('div');
            dealerHandDiv.innerHTML = `<h3>Dealer's Hand ${blackjackState.gameOver || blackjackState.playerStood ? `(${calculateHandValue(blackjackState.dealerCards)})` : ''}</h3>`;
            
            const dealerCardsDiv = document.createElement('div');
            dealerCardsDiv.className = 'hand';
            
            blackjackState.dealerCards.forEach((card, index) => {
                const cardDiv = document.createElement('div');
                if (index === 1 && !blackjackState.gameOver && !blackjackState.playerStood) {
                    cardDiv.className = 'card hidden-card';
                    cardDiv.textContent = '?';
                } else {
                    cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                    cardDiv.innerHTML = `
                        <span class="card-value">${card.value}</span>
                        <span class="card-suit">${card.suit}</span>
                    `;
                }
                dealerCardsDiv.appendChild(cardDiv);
            });
            
            dealerHandDiv.appendChild(dealerCardsDiv);
            gameContent.appendChild(dealerHandDiv);
            
            // Action buttons
            if (!blackjackState.gameOver) {
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'action-buttons';
                
                const hitButton = document.createElement('button');
                hitButton.className = 'btn-borrow-100';
                hitButton.textContent = 'Hit';
                hitButton.onclick = blackjackHit;
                hitButton.disabled = blackjackState.playerStood;
                
                const standButton = document.createElement('button');
                standButton.className = 'btn-borrow-500';
                standButton.textContent = 'Stand';
                standButton.onclick = blackjackStand;
                standButton.disabled = blackjackState.playerStood;
                
                actionsDiv.appendChild(hitButton);
                actionsDiv.appendChild(standButton);
                gameContent.appendChild(actionsDiv);
            }
        }

        function renderRoulette() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';
            
            // Add custom bet input
            addCustomBetInput(gameContent, 10, rouletteState.bet.amount, (newBet) => {
                rouletteState.bet.amount = newBet;
            });
            
            // Betting options
            const betOptionsDiv = document.createElement('div');
            betOptionsDiv.className = 'roulette-bet-options';
            
            // Bet type selector
            const betTypeLabel = document.createElement('label');
            betTypeLabel.textContent = 'Bet on: ';
            
            const betTypeSelect = document.createElement('select');
            betTypeSelect.id = 'bet-type';
            
            const betTypes = [
                { value: 'number', text: 'Single Number' },
                { value: 'color', text: 'Color' },
                { value: 'evenodd', text: 'Even/Odd' },
                { value: 'dozen', text: 'Dozen' }
            ];
            
            betTypes.forEach(type => {
                const option = document.createElement('option');
                option.value = type.value;
                option.textContent = type.text;
                betTypeSelect.appendChild(option);
            });
            
            betTypeSelect.value = rouletteState.bet.type;
            betTypeSelect.onchange = function() {
                rouletteState.bet.type = this.value;
                renderRoulette();
            };
            
            // Value selector (depends on bet type)
            const valueContainer = document.createElement('div');
            
            if (rouletteState.bet.type === 'number') {
                const numberInput = document.createElement('input');
                numberInput.type = 'number';
                numberInput.min = 0;
                numberInput.max = 36;
                numberInput.value = rouletteState.bet.value;
                numberInput.onchange = function() {
                    rouletteState.bet.value = this.value;
                };
                valueContainer.appendChild(numberInput);
            } 
            else if (rouletteState.bet.type === 'color') {
                const colorSelect = document.createElement('select');
                
                const redOption = document.createElement('option');
                redOption.value = 'red';
                redOption.textContent = 'Red';
                
                const blackOption = document.createElement('option');
                blackOption.value = 'black';
                blackOption.textContent = 'Black';
                
                colorSelect.appendChild(redOption);
                colorSelect.appendChild(blackOption);
                
                colorSelect.value = rouletteState.bet.value || 'red';
                colorSelect.onchange = function() {
                    rouletteState.bet.value = this.value;
                };
                
                valueContainer.appendChild(colorSelect);
            } 
            else if (rouletteState.bet.type === 'evenodd') {
                const eoSelect = document.createElement('select');
                
                const evenOption = document.createElement('option');
                evenOption.value = 'even';
                evenOption.textContent = 'Even';
                
                const oddOption = document.createElement('option');
                oddOption.value = 'odd';
                oddOption.textContent = 'Odd';
                
                eoSelect.appendChild(evenOption);
                eoSelect.appendChild(oddOption);
                
                eoSelect.value = rouletteState.bet.value || 'even';
                eoSelect.onchange = function() {
                    rouletteState.bet.value = this.value;
                };
                
                valueContainer.appendChild(eoSelect);
            }
            else if (rouletteState.bet.type === 'dozen') {
                const dozenSelect = document.createElement('select');
                
                const firstOption = document.createElement('option');
                firstOption.value = 'first';
                firstOption.textContent = '1st Dozen (1-12)';
                
                const secondOption = document.createElement('option');
                secondOption.value = 'second';
                secondOption.textContent = '2nd Dozen (13-24)';
                
                const thirdOption = document.createElement('option');
                thirdOption.value = 'third';
                thirdOption.textContent = '3rd Dozen (25-36)';
                
                dozenSelect.appendChild(firstOption);
                dozenSelect.appendChild(secondOption);
                dozenSelect.appendChild(thirdOption);
                
                dozenSelect.value = rouletteState.bet.value || 'first';
                dozenSelect.onchange = function() {
                    rouletteState.bet.value = this.value;
                };
                
                valueContainer.appendChild(dozenSelect);
            }
            
            // Spin button
            const spinButton = document.createElement('button');
            spinButton.className = 'btn-borrow-100';
            spinButton.textContent = 'Spin';
            spinButton.onclick = spinRoulette;
            
            betOptionsDiv.appendChild(betTypeLabel);
            betOptionsDiv.appendChild(betTypeSelect);
            betOptionsDiv.appendChild(valueContainer);
            betOptionsDiv.appendChild(spinButton);
            
            gameContent.appendChild(betOptionsDiv);
            
            // Display result if available
            if (rouletteState.result !== null) {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'roulette-result';
                
                let resultClass = '';
                if (rouletteState.result === 0) {
                    resultClass = 'green';
                } else {
                    // Determine if red or black
                    const isRed = ((rouletteState.result >= 1 && rouletteState.result <= 10) || 
                                   (rouletteState.result >= 19 && rouletteState.result <= 28)) && 
                                   rouletteState.result % 2 === 1 ||
                                  ((rouletteState.result >= 11 && rouletteState.result <= 18) || 
                                   (rouletteState.result >= 29 && rouletteState.result <= 36)) && 
                                   rouletteState.result % 2 === 0;
                    
                    resultClass = isRed ? 'red' : 'black';
                }
                
                resultDiv.className += ' ' + resultClass;
                resultDiv.textContent = rouletteState.result;
                gameContent.appendChild(resultDiv);
            }
            
            // Roulette wheel visualization
            const wheelDiv = document.createElement('div');
            wheelDiv.className = 'roulette-wheel';
            
            // Zero
            const zeroDiv = document.createElement('div');
            zeroDiv.className = 'roulette-number roulette-green';
            zeroDiv.textContent = '0';
            wheelDiv.appendChild(zeroDiv);
            
            // Numbers 1-36
            for (let i = 1; i <= 36; i++) {
                const numDiv = document.createElement('div');
                
                // Determine if red or black
                const isRed = ((i >= 1 && i <= 10) || (i >= 19 && i <= 28)) && i % 2 === 1 ||
                              ((i >= 11 && i <= 18) || (i >= 29 && i <= 36)) && i % 2 === 0;
                
                numDiv.className = `roulette-number ${isRed ? 'roulette-red' : 'roulette-black'}`;
                numDiv.textContent = i;
                wheelDiv.appendChild(numDiv);
            }
            
            gameContent.appendChild(wheelDiv);
        }

        function renderSlots() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';
            
            // Add custom bet input
            addCustomBetInput(gameContent, 5, slotsState.bet, (newBet) => {
                slotsState.bet = newBet;
            });
            
            // Slot machine
            const slotMachineDiv = document.createElement('div');
            slotMachineDiv.className = 'slot-machine';
            
            slotsState.reels.forEach(reel => {
                const reelDiv = document.createElement('div');
                reelDiv.className = 'slot-reel';
                reelDiv.textContent = reel;
                slotMachineDiv.appendChild(reelDiv);
            });
            
            gameContent.appendChild(slotMachineDiv);
        }

        function renderPoker() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';
            
            if (pokerState.gameStage === 'initial') {
                addCustomBetInput(gameContent, 20, pokerState.betAmount, (newBet) => {
                    pokerState.betAmount = newBet;
                });
            }
            
            // Player's hand
            const playerHandDiv = document.createElement('div');
            playerHandDiv.innerHTML = `<h3>Your Hand</h3>`;
            
            const playerCardsDiv = document.createElement('div');
            playerCardsDiv.className = 'hand';
            
            pokerState.playerHand.forEach((card, index) => {
                const cardDiv = document.createElement('div');
                cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                cardDiv.innerHTML = `
                    <span class="card-value">${card.value}</span>
                    <span class="card-suit">${card.suit}</span>
                `;
                
                // Add selection UI if in initial stage
                if (pokerState.gameStage === 'initial') {
                    cardDiv.style.cursor = 'pointer';
                    cardDiv.style.opacity = pokerState.selectedCards[index] ? '1' : '0.7';
                    cardDiv.style.border = pokerState.selectedCards[index] ? '2px solid gold' : '2px solid transparent';
                    
                    cardDiv.onclick = function() {
                        pokerState.selectedCards[index] = !pokerState.selectedCards[index];
                        renderPoker();
                    };
                }
                
                playerCardsDiv.appendChild(cardDiv);
            });
            
            playerHandDiv.appendChild(playerCardsDiv);
            gameContent.appendChild(playerHandDiv);
            
            // Computer's hand (only show in showdown)
            if (pokerState.gameStage === 'showdown') {
                const computerHandDiv = document.createElement('div');
                computerHandDiv.innerHTML = `<h3>Dealer's Hand</h3>`;
                
                const computerCardsDiv = document.createElement('div');
                computerCardsDiv.className = 'hand';
                
                pokerState.computerHand.forEach(card => {
                    const cardDiv = document.createElement('div');
                    cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                    cardDiv.innerHTML = `
                        <span class="card-value">${card.value}</span>
                        <span class="card-suit">${card.suit}</span>
                    `;
                    computerCardsDiv.appendChild(cardDiv);
                });
                
                computerHandDiv.appendChild(computerCardsDiv);
                gameContent.appendChild(computerHandDiv);
            } else {
                // Show card backs for computer
                const computerHandDiv = document.createElement('div');
                computerHandDiv.innerHTML = `<h3>Dealer's Hand</h3>`;
                
                const computerCardsDiv = document.createElement('div');
                computerCardsDiv.className = 'hand';
                
                for (let i = 0; i < 5; i++) {
                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'card hidden-card';
                    cardDiv.textContent = '?';
                    computerCardsDiv.appendChild(cardDiv);
                }
                
                computerHandDiv.appendChild(computerCardsDiv);
                gameContent.appendChild(computerHandDiv);
            }
            
            // Action buttons
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'action-buttons';
            
            if (pokerState.gameStage === 'initial') {
                const drawButton = document.createElement('button');
                drawButton.className = 'btn-borrow-100';
                drawButton.textContent = 'Draw';
                drawButton.onclick = pokerDraw;
                actionsDiv.appendChild(drawButton);
            } else if (pokerState.gameStage === 'draw') {
                const showdownButton = document.createElement('button');
                showdownButton.className = 'btn-borrow-500';
                showdownButton.textContent = 'Showdown';
                showdownButton.onclick = pokerShowdown;
                actionsDiv.appendChild(showdownButton);
            } else if (pokerState.gameStage === 'showdown') {
                const newGameButton = document.createElement('button');
                newGameButton.className = 'btn-borrow-100';
                newGameButton.textContent = 'New Game';
                newGameButton.onclick = startPoker;
                actionsDiv.appendChild(newGameButton);
            }
            
            gameContent.appendChild(actionsDiv);
        }

        function renderCraps() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';
            
            // Add custom bet input
            addCustomBetInput(gameContent, 10, crapsState.betAmount, (newBet) => {
                crapsState.betAmount = newBet;
            });
            
            // Dice visualization
            const diceContainerDiv = document.createElement('div');
            diceContainerDiv.className = 'dice-container';
            
            crapsState.dice.forEach(die => {
                const dieDiv = document.createElement('div');
                dieDiv.className = 'dice';
                dieDiv.textContent = die;
                diceContainerDiv.appendChild(dieDiv);
            });
            
            gameContent.appendChild(diceContainerDiv);
            
            // Show point if established
            if (crapsState.point > 0) {
                const pointDiv = document.createElement('div');
                pointDiv.className = 'game-result';
                pointDiv.textContent = `Point: ${crapsState.point}`;
                gameContent.appendChild(pointDiv);
            }
            
            // Roll button
            const rollButton = document.createElement('button');
            rollButton.className = 'btn-borrow-100';
            rollButton.textContent = crapsState.gameStage === 'come-out' ? 'Come Out Roll' : 'Roll Dice';
            rollButton.onclick = rollCraps;
            
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'action-buttons';
            actionsDiv.appendChild(rollButton);
            gameContent.appendChild(actionsDiv);
        }

        function renderBaccarat() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';
            
            if (baccaratState.gameStage === 'betting') {
                // Add custom bet input
                addCustomBetInput(gameContent, 25, baccaratState.betAmount, (newBet) => {
                    baccaratState.betAmount = newBet;
                });
            }
            
            if (baccaratState.gameStage === 'betting') {
                // Betting options
                const betDiv = document.createElement('div');
                betDiv.className = 'roulette-bet-options';
                
                const betLabel = document.createElement('label');
                betLabel.textContent = 'Bet On: ';
                
                const betTypeSelect = document.createElement('select');
                
                const options = [
                    { value: 'player', text: 'Player' },
                    { value: 'banker', text: 'Banker' },
                    { value: 'tie', text: 'Tie' }
                ];
                
                options.forEach(option => {
                    const opt = document.createElement('option');
                    opt.value = option.value;
                    opt.textContent = option.text;
                    betTypeSelect.appendChild(opt);
                });
                
                betTypeSelect.value = baccaratState.betOn;
                betTypeSelect.onchange = function() {
                    baccaratState.betOn = this.value;
                };
                
                const dealButton = document.createElement('button');
                dealButton.className = 'btn-borrow-100';
                dealButton.textContent = 'Deal';
                dealButton.onclick = dealBaccarat;
                
                betDiv.appendChild(betLabel);
                betDiv.appendChild(betTypeSelect);
                betDiv.appendChild(dealButton);
                gameContent.appendChild(betDiv);
            } 
            else {
                // Display cards and scores
                // Player hand
                const playerHandDiv = document.createElement('div');
                playerHandDiv.innerHTML = `<h3>Player Hand</h3>`;
                
                const playerCardsDiv = document.createElement('div');
                playerCardsDiv.className = 'hand';
                
                baccaratState.playerCards.forEach(card => {
                    const cardDiv = document.createElement('div');
                    cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                    cardDiv.innerHTML = `
                        <span class="card-value">${card.value}</span>
                        <span class="card-suit">${card.suit}</span>
                    `;
                    playerCardsDiv.appendChild(cardDiv);
                });
                
                playerHandDiv.appendChild(playerCardsDiv);
                gameContent.appendChild(playerHandDiv);
                
                // Banker hand
                const bankerHandDiv = document.createElement('div');
                bankerHandDiv.innerHTML = `<h3>Banker Hand</h3>`;
                
                const bankerCardsDiv = document.createElement('div');
                bankerCardsDiv.className = 'hand';
                
                baccaratState.bankerCards.forEach(card => {
                    const cardDiv = document.createElement('div');
                    cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                    cardDiv.innerHTML = `
                        <span class="card-value">${card.value}</span>
                        <span class="card-suit">${card.suit}</span>
                    `;
                    bankerCardsDiv.appendChild(cardDiv);
                });
                
                bankerHandDiv.appendChild(bankerCardsDiv);
                gameContent.appendChild(bankerHandDiv);
                
                // Scores
                const scoreDiv = document.createElement('div');
                scoreDiv.className = 'baccarat-score';
                
                const playerScoreDiv = document.createElement('div');
                playerScoreDiv.textContent = `Player: ${baccaratState.playerScore}`;
                
                const bankerScoreDiv = document.createElement('div');
                bankerScoreDiv.textContent = `Banker: ${baccaratState.bankerScore}`;
                
                scoreDiv.appendChild(playerScoreDiv);
                scoreDiv.appendChild(bankerScoreDiv);
                gameContent.appendChild(scoreDiv);
                
                // New game button if game is over
                if (baccaratState.gameStage === 'result') {
                    const newGameButton = document.createElement('button');
                    newGameButton.className = 'btn-borrow-100';
                    newGameButton.textContent = 'New Game';
                    newGameButton.onclick = startBaccarat;
                    
                    const actionsDiv = document.createElement('div');
                    actionsDiv.className = 'action-buttons';
                    actionsDiv.appendChild(newGameButton);
                    gameContent.appendChild(actionsDiv);
                }
            }
        }

        function renderHoldem() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';

            // Add custom bet input
            addCustomBetInput(gameContent, 50, holdemState.betAmount, (newBet) => {
                holdemState.betAmount = newBet;
            });

            // Player's hand
            const playerHandDiv = document.createElement('div');
            playerHandDiv.innerHTML = `<h3>Your Hand</h3>`;
            
            const playerCardsDiv = document.createElement('div');
            playerCardsDiv.className = 'hand';
            
            holdemState.playerHand.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                cardDiv.innerHTML = `
                    <span class="card-value">${card.value}</span>
                    <span class="card-suit">${card.suit}</span>
                `;
                playerCardsDiv.appendChild(cardDiv);
            });
            
            playerHandDiv.appendChild(playerCardsDiv);
            gameContent.appendChild(playerHandDiv);

            // Community cards
            const communityDiv = document.createElement('div');
            communityDiv.innerHTML = `<h3>Community Cards</h3>`;
            
            const communityCardsDiv = document.createElement('div');
            communityCardsDiv.className = 'hand';
            
            for (let i = 0; i < 5; i++) {
                const cardDiv = document.createElement('div');
                if (i < holdemState.communityCards.length) {
                    const card = holdemState.communityCards[i];
                    cardDiv.className = `card ${(card.suit === '♥' || card.suit === '♦') ? 'card-red' : 'card-black'}`;
                    cardDiv.innerHTML = `
                        <span class="card-value">${card.value}</span>
                        <span class="card-suit">${card.suit}</span>
                    `;
                } else {
                    cardDiv.className = 'card hidden-card';
                    cardDiv.textContent = '?';
                }
                communityCardsDiv.appendChild(cardDiv);
            }
            
            communityDiv.appendChild(communityCardsDiv);
            gameContent.appendChild(communityDiv);

            // Action buttons
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'action-buttons';

            if (!holdemState.playerFolded) {
                if (holdemState.gameStage === 'preflop') {
                    const flopButton = document.createElement('button');
                    flopButton.className = 'btn-borrow-100';
                    flopButton.textContent = 'See Flop';
                    flopButton.onclick = dealFlop;
                    actionsDiv.appendChild(flopButton);

                    const foldButton = document.createElement('button');
                    foldButton.className = 'btn-borrow-500';
                    foldButton.textContent = 'Fold';
                    foldButton.onclick = foldHoldem;
                    actionsDiv.appendChild(foldButton);
                } else if (holdemState.gameStage === 'flop') {
                    const turnButton = document.createElement('button');
                    turnButton.className = 'btn-borrow-100';
                    turnButton.textContent = 'See Turn';
                    turnButton.onclick = dealTurn;
                    actionsDiv.appendChild(turnButton);

                    const foldButton = document.createElement('button');
                    foldButton.className = 'btn-borrow-500';
                    foldButton.textContent = 'Fold';
                    foldButton.onclick = foldHoldem;
                    actionsDiv.appendChild(foldButton);
                } else if (holdemState.gameStage === 'turn') {
                    const riverButton = document.createElement('button');
                    riverButton.className = 'btn-borrow-100';
                    riverButton.textContent = 'See River';
                    riverButton.onclick = dealRiver;
                    actionsDiv.appendChild(riverButton);

                    const foldButton = document.createElement('button');
                    foldButton.className = 'btn-borrow-500';
                    foldButton.textContent = 'Fold';
                    foldButton.onclick = foldHoldem;
                    actionsDiv.appendChild(foldButton);
                } else if (holdemState.gameStage === 'river') {
                    const showdownButton = document.createElement('button');
                    showdownButton.className = 'btn-borrow-100';
                    showdownButton.textContent = 'Showdown';
                    showdownButton.onclick = showdownHoldem;
                    actionsDiv.appendChild(showdownButton);
                }
            } else {
                const newGameButton = document.createElement('button');
                newGameButton.className = 'btn-borrow-100';
                newGameButton.textContent = 'New Game';
                newGameButton.onclick = startHoldem;
                actionsDiv.appendChild(newGameButton);
            }

            gameContent.appendChild(actionsDiv);
        }

        function renderKeno() {
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = '';

            // Add custom bet input
            addCustomBetInput(gameContent, 10, kenoState.betAmount, (newBet) => {
                kenoState.betAmount = newBet;
            });

            // Number grid
            const gridDiv = document.createElement('div');
            gridDiv.className = 'keno-grid';
            gridDiv.style.display = 'grid';
            gridDiv.style.gridTemplateColumns = 'repeat(10, 1fr)';
            gridDiv.style.gap = '5px';
            gridDiv.style.marginBottom = '20px';

            for (let i = 1; i <= 80; i++) {
                const numberDiv = document.createElement('div');
                numberDiv.className = 'keno-number';
                numberDiv.textContent = i;
                numberDiv.style.padding = '10px';
                numberDiv.style.textAlign = 'center';
                numberDiv.style.backgroundColor = kenoState.selectedNumbers.includes(i) ? '#4caf50' : '#333';
                numberDiv.style.cursor = 'pointer';
                numberDiv.style.borderRadius = '5px';

                if (kenoState.gameStage === 'selecting') {
                    numberDiv.onclick = () => toggleKenoNumber(i);
                }

                if (kenoState.drawnNumbers.includes(i)) {
                    numberDiv.style.backgroundColor = '#ffcc00';
                }

                gridDiv.appendChild(numberDiv);
            }

            gameContent.appendChild(gridDiv);

            // Action buttons
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'action-buttons';

            if (kenoState.gameStage === 'selecting') {
                const drawButton = document.createElement('button');
                drawButton.className = 'btn-borrow-100';
                drawButton.textContent = 'Draw Numbers';
                drawButton.onclick = drawKenoNumbers;
                drawButton.disabled = kenoState.selectedNumbers.length < 1;
                actionsDiv.appendChild(drawButton);
            } else {
                const newGameButton = document.createElement('button');
                newGameButton.className = 'btn-borrow-100';
                newGameButton.textContent = 'New Game';
                newGameButton.onclick = startKeno;
                actionsDiv.appendChild(newGameButton);
            }

            gameContent.appendChild(actionsDiv);
        }

        // Make render functions globally accessible
        window.renderBlackjack = renderBlackjack;
        window.renderRoulette = renderRoulette;
        window.renderSlots = renderSlots;
        window.renderPoker = renderPoker;
        window.renderCraps = renderCraps;
        window.renderBaccarat = renderBaccarat;
        window.renderHoldem = renderHoldem;
        window.renderKeno = renderKeno;

        // Game action functions
        function blackjackHit() {
            if (blackjackState.gameOver || blackjackState.playerStood) return;
            
            playSound('deal');
            blackjackState.playerCards.push(getRandomCard());
            blackjackState.playerValue = calculateHandValue(blackjackState.playerCards);
            
            if (blackjackState.playerValue > 21) {
                blackjackState.gameOver = true;
                bank -= blackjackState.betAmount;
                updateUI();
                playSound('lose');
                updateStats(blackjackState.betAmount, false);
                setGameResult(`Bust! You lose $${blackjackState.betAmount}!`);
            }
            
            renderBlackjack();
        }

        function blackjackStand() {
            if (blackjackState.gameOver || blackjackState.playerStood) return;
            
            blackjackState.playerStood = true;
            
            while (calculateHandValue(blackjackState.dealerCards) < 17) {
                blackjackState.dealerCards.push(getRandomCard());
            }
            
            const dealerValue = calculateHandValue(blackjackState.dealerCards);
            blackjackState.gameOver = true;
            
            if (dealerValue > 21) {
                bank += blackjackState.betAmount * 2;
                updateUI();
                playSound('win');
                updateStats(blackjackState.betAmount * 2, true);
                setGameResult(`Dealer busts! You win $${blackjackState.betAmount * 2}!`);
            } else if (dealerValue > blackjackState.playerValue) {
                bank -= blackjackState.betAmount;
                updateUI();
                playSound('lose');
                updateStats(blackjackState.betAmount, false);
                setGameResult(`Dealer wins! You lose $${blackjackState.betAmount}!`);
            } else if (dealerValue < blackjackState.playerValue) {
                bank += blackjackState.betAmount * 2;
                updateUI();
                playSound('win');
                updateStats(blackjackState.betAmount * 2, true);
                setGameResult(`You win $${blackjackState.betAmount * 2}!`);
            } else {
                setGameResult("Push! Your bet is returned.");
            }
            
            renderBlackjack();
        }

        function spinRoulette() {
            if (bank < rouletteState.bet.amount) {
                setGameResult("You don't have enough money for this bet!");
                return;
            }
            
            bank -= rouletteState.bet.amount;
            updateUI();
            
            const result = Math.floor(Math.random() * 37);
            rouletteState.result = result;
            
            let win = false;
            let multiplier = 0;
            
            switch (rouletteState.bet.type) {
                case 'number':
                    win = result === parseInt(rouletteState.bet.value);
                    multiplier = 35;
                    break;
                case 'color':
                    const isRed = ((result >= 1 && result <= 10) || (result >= 19 && result <= 28)) && result % 2 === 1 ||
                                 ((result >= 11 && result <= 18) || (result >= 29 && result <= 36)) && result % 2 === 0;
                    win = (isRed && rouletteState.bet.value === 'red') || (!isRed && rouletteState.bet.value === 'black');
                    multiplier = 1;
                    break;
                case 'evenodd':
                    win = (result % 2 === 0 && rouletteState.bet.value === 'even') ||
                          (result % 2 === 1 && rouletteState.bet.value === 'odd');
                    multiplier = 1;
                    break;
                case 'dozen':
                    const dozen = Math.ceil(result / 12);
                    win = (dozen === 1 && rouletteState.bet.value === 'first') ||
                          (dozen === 2 && rouletteState.bet.value === 'second') ||
                          (dozen === 3 && rouletteState.bet.value === 'third');
                    multiplier = 2;
                    break;
            }
            
            if (win) {
                const winnings = rouletteState.bet.amount * (multiplier + 1);
                bank += winnings;
                updateUI();
                playSound('win');
                updateStats(winnings, true);
                setGameResult(`You win $${winnings}!`);
            } else {
                setGameResult("You lose!");
            }
            
            renderRoulette();
        }

        function spinSlots() {
            if (bank < slotsState.bet) {
                setGameResult("You don't have enough money for this bet!");
                return;
            }
            
            bank -= slotsState.bet;
            updateUI();
            
            const symbols = ['🍒', '🍊', '🍋', '🍇', '7️⃣', '💎'];
            slotsState.reels = [
                symbols[Math.floor(Math.random() * symbols.length)],
                symbols[Math.floor(Math.random() * symbols.length)],
                symbols[Math.floor(Math.random() * symbols.length)]
            ];
            
            const [a, b, c] = slotsState.reels;
            let winnings = 0;
            
            if (a === b && b === c) {
                if (a === '💎') {
                    winnings = slotsState.bet * 10;
                } else if (a === '7️⃣') {
                    winnings = slotsState.bet * 5;
                } else {
                    winnings = slotsState.bet * 3;
                }
            } else if (a === b || b === c || a === c) {
                winnings = slotsState.bet;
            }
            
            if (winnings > 0) {
                bank += winnings;
                updateUI();
                playSound('win');
                updateStats(winnings, true);
                setGameResult(`You win $${winnings}!`);
            } else {
                setGameResult("Try again!");
            }
            
            renderSlots();
        }

        function pokerDraw() {
            const selectedCount = pokerState.selectedCards.filter(selected => !selected).length;
            
            for (let i = 0; i < 5; i++) {
                if (!pokerState.selectedCards[i]) {
                    pokerState.playerHand[i] = pokerState.deck.pop();
                }
            }
            
            pokerState.gameStage = 'draw';
            renderPoker();
        }

        function pokerShowdown() {
            pokerState.gameStage = 'showdown';
            
            // Simple hand evaluation
            const playerValue = evaluatePokerHand(pokerState.playerHand);
            const computerValue = evaluatePokerHand(pokerState.computerHand);
            
            if (playerValue > computerValue) {
                bank += 40;
                updateUI();
                playSound('win');
                updateStats(40, true);
                setGameResult("You win $40!");
            } else if (playerValue < computerValue) {
                bank -= 20;
                updateUI();
                playSound('lose');
                updateStats(20, false);
                setGameResult("Dealer wins! You lose $20!");
            } else {
                setGameResult("Push! Your bet is returned.");
            }
            
            renderPoker();
        }

        function evaluatePokerHand(hand) {
            // Simple hand evaluation
            const values = hand.map(card => {
                if (card.value === 'A') return 14;
                if (card.value === 'K') return 13;
                if (card.value === 'Q') return 12;
                if (card.value === 'J') return 11;
                return parseInt(card.value);
            });
            
            const suits = hand.map(card => card.suit);
            
            // Check for flush
            const isFlush = suits.every(suit => suit === suits[0]);
            
            // Check for straight
            values.sort((a, b) => a - b);
            const isStraight = values.every((val, i) => i === 0 || val === values[i - 1] + 1);
            
            // Count pairs, three of a kind, etc.
            const valueCounts = {};
            values.forEach(val => {
                valueCounts[val] = (valueCounts[val] || 0) + 1;
            });
            
            const counts = Object.values(valueCounts);
            
            if (isFlush && isStraight) return 8; // Straight flush
            if (counts.includes(4)) return 7; // Four of a kind
            if (counts.includes(3) && counts.includes(2)) return 6; // Full house
            if (isFlush) return 5; // Flush
            if (isStraight) return 4; // Straight
            if (counts.includes(3)) return 3; // Three of a kind
            if (counts.filter(c => c === 2).length === 2) return 2; // Two pair
            if (counts.includes(2)) return 1; // One pair
            return 0; // High card
        }

        function rollCraps() {
            if (bank < crapsState.betAmount) {
                setGameResult("You don't have enough money for this bet!");
                return;
            }
            
            bank -= crapsState.betAmount;
            updateUI();
            
            crapsState.dice = [
                Math.floor(Math.random() * 6) + 1,
                Math.floor(Math.random() * 6) + 1
            ];
            
            const sum = crapsState.dice[0] + crapsState.dice[1];
            
            if (crapsState.gameStage === 'come-out') {
                if (sum === 7 || sum === 11) {
                    bank += crapsState.betAmount * 2;
                    updateUI();
                    playSound('win');
                    updateStats(crapsState.betAmount * 2, true);
                    setGameResult("Natural! You win!");
                    crapsState.gameStage = 'come-out';
                } else if (sum === 2 || sum === 3 || sum === 12) {
                    setGameResult("Craps! You lose!");
                    crapsState.gameStage = 'come-out';
                } else {
                    crapsState.point = sum;
                    crapsState.gameStage = 'point';
                    playSound('deal');
                    setGameResult(`Point is ${sum}. Roll again!`);
                }
            } else {
                if (sum === crapsState.point) {
                    bank += crapsState.betAmount * 2;
                    updateUI();
                    playSound('win');
                    updateStats(crapsState.betAmount * 2, true);
                    setGameResult("You win!");
                    crapsState.gameStage = 'come-out';
                    crapsState.point = 0;
                } else if (sum === 7) {
                    setGameResult("Seven out! You lose!");
                    crapsState.gameStage = 'come-out';
                    crapsState.point = 0;
                } else {
                    playSound('deal');
                    setGameResult(`Roll again! Point is ${crapsState.point}`);
                }
            }
            
            renderCraps();
        }

        function dealBaccarat() {
            if (bank < baccaratState.betAmount) {
                setGameResult("You don't have enough money for this bet!");
                return;
            }
            
            bank -= baccaratState.betAmount;
            updateUI();
            
            const deck = generateDeck();
            
            // Deal initial cards
            baccaratState.playerCards = [deck.pop(), deck.pop()];
            baccaratState.bankerCards = [deck.pop(), deck.pop()];
            
            // Calculate initial scores
            baccaratState.playerScore = calculateBaccaratScore(baccaratState.playerCards);
            baccaratState.bankerScore = calculateBaccaratScore(baccaratState.bankerCards);
            
            // Draw third card if needed
            if (baccaratState.playerScore <= 5) {
                baccaratState.playerCards.push(deck.pop());
                baccaratState.playerScore = calculateBaccaratScore(baccaratState.playerCards);
            }
            
            if (baccaratState.bankerScore <= 5) {
                baccaratState.bankerCards.push(deck.pop());
                baccaratState.bankerScore = calculateBaccaratScore(baccaratState.bankerCards);
            }
            
            // Determine winner
            let winnings = 0;
            if (baccaratState.playerScore > baccaratState.bankerScore) {
                if (baccaratState.betOn === 'player') {
                    winnings = baccaratState.betAmount * 2;
                }
            } else if (baccaratState.bankerScore > baccaratState.playerScore) {
                if (baccaratState.betOn === 'banker') {
                    winnings = baccaratState.betAmount * 1.95;
                }
            } else {
                if (baccaratState.betOn === 'tie') {
                    winnings = baccaratState.betAmount * 9;
                } else {
                    winnings = baccaratState.betAmount;
                }
            }
            
            if (winnings > 0) {
                bank += winnings;
                updateUI();
                playSound('win');
                updateStats(winnings, true);
                setGameResult(`You win $${winnings}!`);
            } else {
                setGameResult("You lose!");
            }
            
            baccaratState.gameStage = 'result';
            renderBaccarat();
        }

        function dealFlop() {
            holdemState.communityCards = dealCards(holdemState.deck, 3);
            holdemState.gameStage = 'flop';
            playSound('deal');
            renderHoldem();
        }

        function dealTurn() {
            holdemState.communityCards.push(holdemState.deck.pop());
            holdemState.gameStage = 'turn';
            playSound('deal');
            renderHoldem();
        }

        function dealRiver() {
            holdemState.communityCards.push(holdemState.deck.pop());
            holdemState.gameStage = 'river';
            playSound('deal');
            renderHoldem();
        }

        function foldHoldem() {
            holdemState.playerFolded = true;
            playSound('lose');
            updateStats(holdemState.betAmount, false);
            setGameResult("You folded! You lose $" + holdemState.betAmount);
            renderHoldem();
        }

        function showdownHoldem() {
            const playerScore = evaluateHoldemHand([...holdemState.playerHand, ...holdemState.communityCards]);
            const dealerScore = evaluateHoldemHand([...holdemState.dealerHand, ...holdemState.communityCards]);

            if (playerScore > dealerScore) {
                bank += holdemState.pot * 2;
                updateUI();
                playSound('win');
                updateStats(holdemState.pot, true);
                setGameResult("You win $" + (holdemState.pot * 2) + "!");
            } else if (playerScore < dealerScore) {
                playSound('lose');
                updateStats(holdemState.betAmount, false);
                setGameResult("Dealer wins! You lose $" + holdemState.betAmount);
            } else {
                bank += holdemState.pot;
                updateUI();
                setGameResult("Push! Your bet is returned.");
            }

            holdemState.gameStage = 'showdown';
            renderHoldem();
        }

        function evaluateHoldemHand(cards) {
            // Simple hand evaluation (you can make this more sophisticated)
            const values = cards.map(card => {
                if (card.value === 'A') return 14;
                if (card.value === 'K') return 13;
                if (card.value === 'Q') return 12;
                if (card.value === 'J') return 11;
                return parseInt(card.value);
            });

            // Check for pairs, three of a kind, etc.
            const valueCounts = {};
            values.forEach(value => {
                valueCounts[value] = (valueCounts[value] || 0) + 1;
            });

            let score = 0;
            // Add points for pairs, three of a kind, etc.
            Object.values(valueCounts).forEach(count => {
                if (count === 2) score += 2;
                if (count === 3) score += 6;
                if (count === 4) score += 12;
            });

            return score;
        }

        function toggleKenoNumber(number) {
            const index = kenoState.selectedNumbers.indexOf(number);
            if (index === -1) {
                if (kenoState.selectedNumbers.length < 10) {
                    kenoState.selectedNumbers.push(number);
                }
            } else {
                kenoState.selectedNumbers.splice(index, 1);
            }
            renderKeno();
        }

        function drawKenoNumbers() {
            if (kenoState.selectedNumbers.length < 1) return;

            bank -= kenoState.betAmount;
            updateUI();

            const allNumbers = Array.from({length: 80}, (_, i) => i + 1);
            kenoState.drawnNumbers = [];
            
            for (let i = 0; i < 20; i++) {
                const randomIndex = Math.floor(Math.random() * allNumbers.length);
                kenoState.drawnNumbers.push(allNumbers.splice(randomIndex, 1)[0]);
            }

            const matches = kenoState.selectedNumbers.filter(num => kenoState.drawnNumbers.includes(num));
            const winnings = calculateKenoWinnings(matches.length, kenoState.selectedNumbers.length, kenoState.betAmount);

            if (winnings > 0) {
                bank += winnings;
                updateUI();
                playSound('win');
                updateStats(winnings - kenoState.betAmount, true);
                setGameResult(`You matched ${matches.length} numbers! You win $${winnings}!`);
            } else {
                playSound('lose');
                updateStats(kenoState.betAmount, false);
                setGameResult(`You matched ${matches.length} numbers. You lose $${kenoState.betAmount}`);
            }

            kenoState.gameStage = 'result';
            renderKeno();
        }

        function calculateKenoWinnings(matches, spots, bet) {
            // Simple payout structure (you can make this more sophisticated)
            const payouts = {
                1: {1: 3},    // 1 spot: 3x for 1 match
                2: {2: 10},   // 2 spots: 10x for 2 matches
                3: {2: 2, 3: 25}, // 3 spots: 2x for 2 matches, 25x for 3 matches
                4: {2: 1, 3: 5, 4: 100}, // 4 spots: 1x for 2 matches, 5x for 3 matches, 100x for 4 matches
                5: {3: 2, 4: 10, 5: 500} // 5 spots: 2x for 3 matches, 10x for 4 matches, 500x for 5 matches
            };

            if (payouts[spots] && payouts[spots][matches]) {
                return bet * payouts[spots][matches];
            }
            return 0;
        }

        // Make game action functions globally accessible
        window.blackjackHit = blackjackHit;
        window.blackjackStand = blackjackStand;
        window.spinRoulette = spinRoulette;
        window.spinSlots = spinSlots;
        window.pokerDraw = pokerDraw;
        window.pokerShowdown = pokerShowdown;
        window.rollCraps = rollCraps;
        window.dealBaccarat = dealBaccarat;
        window.dealFlop = dealFlop;
        window.dealTurn = dealTurn;
        window.dealRiver = dealRiver;
        window.foldHoldem = foldHoldem;
        window.showdownHoldem = showdownHoldem;

        // Add custom bet amount input
        function addCustomBetInput(gameContent, minBet, currentBet, onBetChange) {
            const betDiv = document.createElement('div');
            betDiv.className = 'roulette-bet-options';
            
            const betLabel = document.createElement('label');
            betLabel.textContent = 'Bet Amount: $';
            
            const betInput = document.createElement('input');
            betInput.type = 'number';
            betInput.min = minBet;
            betInput.step = minBet;
            betInput.value = currentBet;
            betInput.onchange = function() {
                const newBet = parseInt(this.value);
                if (newBet < minBet) {
                    this.value = minBet;
                    onBetChange(minBet);
                } else if (newBet > bank) {
                    this.value = bank;
                    onBetChange(bank);
                } else {
                    onBetChange(newBet);
                }
            };
            
            betDiv.appendChild(betLabel);
            betDiv.appendChild(betInput);
            gameContent.appendChild(betDiv);
            return betDiv;
        }

        // Update statistics
        function updateStats(amount, isWin) {
            if (isWin) {
                stats.totalWins++;
                stats.totalWon += amount;
                stats.currentStreak++;
                if (amount > stats.biggestWin) {
                    stats.biggestWin = amount;
                }
            } else {
                stats.totalLosses++;
                stats.totalLost += amount;
                stats.currentStreak = 0;
            }
            stats.gamesPlayed++;

            // Save to localStorage
            localStorage.setItem('casinoStats', JSON.stringify(stats));
            updateStatsDisplay();
            checkAchievements();
        }

        // Update statistics display
        function updateStatsDisplay() {
            document.getElementById('total-wins').textContent = stats.totalWins;
            document.getElementById('total-losses').textContent = stats.totalLosses;
            document.getElementById('biggest-win').textContent = '$' + stats.biggestWin;
            document.getElementById('current-streak').textContent = stats.currentStreak;
        }

        // Check and update achievements
        function checkAchievements() {
            // High Roller
            if (stats.biggestWin >= 1000 && !unlockedAchievements.includes('high_roller')) {
                unlockAchievement('high_roller');
            }

            // Lucky Streak
            if (stats.currentStreak >= 5 && !unlockedAchievements.includes('lucky_streak')) {
                unlockAchievement('lucky_streak');
            }

            // Debt Free
            if (debt === 0 && !unlockedAchievements.includes('debt_free')) {
                unlockAchievement('debt_free');
            }

            // Jackpot Hunter
            if (stats.biggestWin >= 1000 && !unlockedAchievements.includes('jackpot_hunter')) {
                unlockAchievement('jackpot_hunter');
            }
        }

        // Unlock achievement
        function unlockAchievement(id) {
            if (!unlockedAchievements.includes(id)) {
                unlockedAchievements.push(id);
                localStorage.setItem('achievements', JSON.stringify(unlockedAchievements));
                const achievement = achievements.find(a => a.id === id);
                if (achievement) {
                    showAchievementNotification(achievement);
                }
                renderAchievements();
            }
        }

        // Show achievement notification
        function showAchievementNotification(achievement) {
            const notification = document.createElement('div');
            notification.className = 'achievement-notification';
            notification.innerHTML = `
                <div class="achievement-icon">${achievement.icon}</div>
                <div>
                    <div class="achievement-name">${achievement.name}</div>
                    <div class="achievement-description">${achievement.description}</div>
                </div>
            `;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 5000);
        }

        // Render achievements
        function renderAchievements() {
            const achievementsList = document.getElementById('achievements-list');
            achievementsList.innerHTML = '';
            
            achievements.forEach(achievement => {
                const div = document.createElement('div');
                div.className = `achievement ${unlockedAchievements.includes(achievement.id) ? 'unlocked' : ''}`;
                div.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div>
                        <div class="achievement-name">${achievement.name}</div>
                        <div class="achievement-description">${achievement.description}</div>
                    </div>
                `;
                achievementsList.appendChild(div);
            });
        }

        // Theme toggle
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
        }

        // Load theme preference
        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-theme');
        }

        // Initialize achievements display
        renderAchievements();

        // Modify existing game functions to include sound effects and stats tracking
        function playSound(sound) {
            sounds[sound].currentTime = 0;
            sounds[sound].play();
        }

        // Initialize UI
        updateUI();
        updateStatsDisplay();

        // Update leaderboard
        function updateLeaderboard() {
            const leaderboardList = document.getElementById('leaderboard-list');
            leaderboardList.innerHTML = '';

            // Sort leaderboard by total won
            const sortedLeaderboard = [...leaderboard].sort((a, b) => b.totalWon - a.totalWon);

            sortedLeaderboard.forEach((player, index) => {
                const div = document.createElement('div');
                div.className = 'leaderboard-item';
                div.innerHTML = `
                    <div class="player-info">
                        <div class="player-avatar">${player.avatar}</div>
                        <div>${player.name}</div>
                    </div>
                    <div>$${player.totalWon}</div>
                `;
                leaderboardList.appendChild(div);
            });
        }

        // Send chat message
        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (message) {
                const chatMessage = {
                    player: playerName,
                    avatar: playerAvatar,
                    message: message,
                    timestamp: new Date().toISOString()
                };
                
                chatMessages.push(chatMessage);
                if (chatMessages.length > 50) chatMessages.shift(); // Keep only last 50 messages
                
                localStorage.setItem('chatMessages', JSON.stringify(chatMessages));
                renderChatMessages();
                input.value = '';
            }
        }

        // Render chat messages
        function renderChatMessages() {
            const chatMessagesDiv = document.getElementById('chat-messages');
            chatMessagesDiv.innerHTML = '';
            
            chatMessages.forEach(msg => {
                const div = document.createElement('div');
                div.className = 'chat-message';
                div.innerHTML = `
                    <div class="player-info">
                        <div class="player-avatar">${msg.avatar}</div>
                        <div>
                            <strong>${msg.player}</strong>
                            <div>${msg.message}</div>
                        </div>
                    </div>
                `;
                chatMessagesDiv.appendChild(div);
            });
            
            chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight;
        }

        // Update player stats in leaderboard
        function updatePlayerStats() {
            const playerIndex = leaderboard.findIndex(p => p.name === playerName);
            const playerStats = {
                name: playerName,
                avatar: playerAvatar,
                totalWon: stats.totalWon,
                gamesPlayed: stats.gamesPlayed,
                biggestWin: stats.biggestWin
            };

            if (playerIndex === -1) {
                leaderboard.push(playerStats);
            } else {
                leaderboard[playerIndex] = playerStats;
            }

            localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
            updateLeaderboard();
        }

        // Modify updateStats to include leaderboard update
        const originalUpdateStats = updateStats;
        updateStats = function(amount, isWin) {
            originalUpdateStats(amount, isWin);
            updatePlayerStats();
        };

        // Initialize social features
        renderChatMessages();
        updateLeaderboard();

        // Add chat input enter key handler
        document.getElementById('chat-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });

        // Settings toggle
        function toggleSettings() {
            document.getElementById('settings-overlay').classList.toggle('active');
            document.getElementById('settings-panel').classList.toggle('active');
        }

        // Reset game
        function resetGame() {
            bank = 0;
            debt = 0;
            stats = { totalWins: 0, totalLosses: 0, biggestWin: 0, currentStreak: 0, gamesPlayed: 0, totalWon: 0, totalLost: 0 };
            localStorage.removeItem('bank');
            localStorage.removeItem('debt');
            localStorage.removeItem('casinoStats');
            localStorage.removeItem('achievements');
            localStorage.removeItem('chatMessages');
            localStorage.removeItem('leaderboard');
            updateUI();
            updateStatsDisplay();
            resetAchievements();
            resetChatMessages();
            resetLeaderboard();
        }

        // Reset statistics
        function resetStats() {
            stats = { totalWins: 0, totalLosses: 0, biggestWin: 0, currentStreak: 0, gamesPlayed: 0, totalWon: 0, totalLost: 0 };
            localStorage.removeItem('casinoStats');
            updateStatsDisplay();
        }

        // Reset achievements
        function resetAchievements() {
            unlockedAchievements = [];
            localStorage.removeItem('achievements');
            renderAchievements();
        }

        // Reset chat messages
        function resetChatMessages() {
            chatMessages = [];
            localStorage.removeItem('chatMessages');
            renderChatMessages();
        }

        // Reset leaderboard
        function resetLeaderboard() {
            leaderboard = [];
            localStorage.removeItem('leaderboard');
            updateLeaderboard();
        }
    </script>
</body>
</html>
